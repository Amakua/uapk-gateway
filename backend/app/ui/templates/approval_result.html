{% extends "base.html" %}

{% block content %}
<style>
    .result-card {
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 2rem;
        text-align: center;
        max-width: 600px;
        margin: 0 auto;
    }
    .result-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
    }
    .result-icon.approved { color: var(--success); }
    .result-icon.denied { color: var(--danger); }
    .result-title {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }
    .result-subtitle {
        color: var(--text-muted);
        margin-bottom: 2rem;
    }
    .token-box {
        background: #1e293b;
        border-radius: 6px;
        padding: 1rem;
        margin: 1.5rem 0;
        text-align: left;
    }
    .token-label {
        color: #94a3b8;
        font-size: 0.875rem;
        margin-bottom: 0.5rem;
    }
    .token-value {
        color: #22c55e;
        font-family: monospace;
        font-size: 0.75rem;
        word-break: break-all;
        line-height: 1.4;
    }
    .copy-btn {
        margin-top: 0.75rem;
        padding: 0.5rem 1rem;
        background: #334155;
        color: #e2e8f0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.875rem;
    }
    .copy-btn:hover {
        background: #475569;
    }
    .expires-info {
        color: #94a3b8;
        font-size: 0.875rem;
        margin-top: 0.5rem;
    }
    .action-links {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 2rem;
    }
    .btn {
        padding: 0.75rem 1.5rem;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 500;
    }
    .btn-primary {
        background: var(--primary);
        color: white;
    }
    .btn-primary:hover {
        background: var(--primary-dark);
    }
    .btn-secondary {
        background: var(--border);
        color: var(--text);
    }
</style>

<div class="result-card">
    {% if action == 'approved' %}
    <div class="result-icon approved">&#10003;</div>
    <h1 class="result-title">Action Approved</h1>
    <p class="result-subtitle">The approval request has been approved.</p>

    {% if result.override_token %}
    <div class="token-box">
        <div class="token-label">Override Token</div>
        <div class="token-value" id="override-token">{{ result.override_token }}</div>
        <div class="expires-info">
            Expires: {{ result.override_token_expires_at.strftime('%Y-%m-%d %H:%M:%S UTC') }}
        </div>
        <button class="copy-btn" onclick="copyToken()">Copy Token</button>
    </div>
    <p style="color: var(--text-muted); font-size: 0.875rem;">
        The agent can use this token to execute the approved action.
        The token is short-lived and bound to this specific action.
    </p>
    {% endif %}

    {% else %}
    <div class="result-icon denied">&#10007;</div>
    <h1 class="result-title">Action Denied</h1>
    <p class="result-subtitle">The approval request has been denied.</p>
    <p style="color: var(--text-muted); font-size: 0.875rem;">
        The agent will not be able to execute this action.
    </p>
    {% endif %}

    <div class="action-links">
        <a href="/ui/approvals" class="btn btn-primary">Back to Approvals</a>
        <a href="/ui/approvals/{{ result.approval_id }}" class="btn btn-secondary">View Details</a>
    </div>
</div>

<script>
function copyToken() {
    const token = document.getElementById('override-token').textContent;
    navigator.clipboard.writeText(token).then(() => {
        const btn = document.querySelector('.copy-btn');
        btn.textContent = 'Copied!';
        setTimeout(() => {
            btn.textContent = 'Copy Token';
        }, 2000);
    });
}
</script>
{% endblock %}
